<!DOCTYPE html>
<html>
<head>
  <title>CSS 3D</title>
	<style>
		.standpoint{
			position:relative;
			width:800px;
			height:600px;
			border:3px dashed #F00;
			/*perspective-origin:center center;
			-webkit-perspective-origin:600px center;
			perspective:600px;
			-webkit-perspective:600px;
			transform-style:preserve-3d;
			-webkit-transform-style:preserve-3d;*/
		}
		.wall{
			position: absolute;
			width:526px;
			height:395px;
			border:2px solid #0F0;
			background-color: #0F0;
			transform:translateX(137px) translateY(102.5px) rotateY(45deg);
			-webkit-transform:translateX(137px) translateY(102.5px) rotateY(45deg);
		}
		.photo{
			position: absolute;
			width:526px;
			height:395px;
			border:1px solid #00F;
			background-image:url(./sandy.jpg);
			transform:translateX(137px) translateY(102.5px) rotateY(45deg);
			-webkit-transform:translateX(137px) translateY(102.5px) rotateY(-45deg);
			/*transform-origin:center center;*/
		}
		fieldset{
			width:800px;
		}
	</style>
<script>
function change_depth(obj)
{
  var value=obj.value;
  var s="stand";

  val=value+"px";
  document.getElementById(s).style.Perspective=val;
  document.getElementById(s).style.WebkitPerspective=val;

}
function change_position(obj)
{
 
  var target = obj.id;
  var value = obj.value;
  var s="stand";
 
  if(target=="X")
    val=value+"px center";
  else
    val="center "+value+"px";

  document.getElementById(s).style.perspectiveOrigin=val;
  document.getElementById(s).style.WebkitPerspectiveOrigin=val;
}

function change_preserve(obj)
{
  var s="stand";
  if(obj.checked)
  {
	document.getElementById(s).style.transformStyle="preserve-3d";
    document.getElementById(s).style.WebkitTransformStyle="preserve-3d";
  }
  else
  {
  	document.getElementById(s).style.transformStyle="flat";
    document.getElementById(s).style.WebkitTransformStyle="flat";
  }
}

function Translate(obj)
{
  var target = obj.id;
  var value = obj.value;
  var s="photo";
  var PrefixMatrix = "matrix3d("; 
  var CssString = window.getComputedStyle(document.getElementById(s), null).getPropertyValue("transform"); //利用getComputedStyle取得元素上CSS transform屬性值，結果是matrix3d(,,,,,,,,,,,)字串
  Parameters = CssString.substring(PrefixMatrix.length,CssString.length-1).split(", ");
  
  switch(target)
  {
  	case "Tx": 
      Parameters[12]=value;
      val = PrefixMatrix+Parameters.join()+")";
      document.getElementById(s).style.transform=val;
  	  document.getElementById(s).style.WebkitTransform=val;	  
  	  break;
	  case "Ty":
      Parameters[13]=value;
      val = PrefixMatrix+Parameters.join()+")";
      document.getElementById(s).style.transform=val;
  	  document.getElementById(s).style.WebkitTransform=val;
  	  break;
  	case "Tz":
      Parameters[14]=value;
      val = PrefixMatrix+Parameters.join()+")";
      document.getElementById(s).style.transform=val;
  	  document.getElementById(s).style.WebkitTransform=val;
  	  break;
  }
}

function Scale(obj)
{
  var target = obj.id;
  var value = obj.value;
  var s="photo";
  var PrefixMatrix = "matrix3d("; 
  var CssString = window.getComputedStyle(document.getElementById(s), null).getPropertyValue("transform"); //利用getComputedStyle取得元素上CSS transform屬性值，結果是matrix3d(,,,,,,,,,,,)字串
  Parameters = CssString.substring(PrefixMatrix.length,CssString.length-1).split(", ");
  
  switch(target)
  {
    case "Sx": 
      Parameters[0]=value;
      val = PrefixMatrix+Parameters.join()+")";
      document.getElementById(s).style.transform=val;
      document.getElementById(s).style.WebkitTransform=val;    
      break;
    case "Sy":
      Parameters[5]=value;
      val = PrefixMatrix+Parameters.join()+")";
      document.getElementById(s).style.transform=val;
      document.getElementById(s).style.WebkitTransform=val;
      break;
    case "Sz":
      Parameters[10]=value;
      val = PrefixMatrix+Parameters.join()+")";
      document.getElementById(s).style.transform=val;
      document.getElementById(s).style.WebkitTransform=val;
      break;
  }
}

function toRadian(degree)
{
	return (degree/180)*Math.PI;
}

function Rotate(obj)
{
  var target = obj.id;
  var value = obj.value;
  var s="photo";
  var PrefixMatrix = "matrix3d("; 
  var CssString = window.getComputedStyle(document.getElementById(s), null).getPropertyValue("transform"); //利用getComputedStyle取得元素上CSS transform屬性值，結果是matrix3d(,,,,,,,,,,,)字串
  Parameters = CssString.substring(PrefixMatrix.length,CssString.length-1).split(", ");
  
  switch(target)
  {
    case "Rx": 
      Parameters[5]=Math.cos(toRadian(value));
      Parameters[6]=Math.sin(toRadian(value));
      Parameters[9]=-Math.sin(toRadian(value));
      Parameters[10]=Math.cos(toRadian(value));
      val = PrefixMatrix+Parameters.join()+")";
      document.getElementById(s).style.transform=val;
      document.getElementById(s).style.WebkitTransform=val;
      break;
    case "Ry":
      Parameters[0]=Math.cos(toRadian(value));
      Parameters[2]=-Math.sin(toRadian(value));
      Parameters[8]=Math.sin(toRadian(value));
      Parameters[10]=Math.cos(toRadian(value));
      val = PrefixMatrix+Parameters.join()+")";
      document.getElementById(s).style.transform=val;
      document.getElementById(s).style.WebkitTransform=val;
      break;
    case "Rz":
      Parameters[0]=Math.cos(toRadian(value));
      Parameters[1]=Math.sin(toRadian(value));
      Parameters[4]=-Math.sin(toRadian(value));
      Parameters[5]=Math.cos(toRadian(value));
      val = PrefixMatrix+Parameters.join()+")";
      document.getElementById(s).style.transform=val;
      document.getElementById(s).style.WebkitTransform=val;
      break;
  }
}

function Skew(obj)
{
  var target = obj.id;
  var value = obj.value;
  var s="photo";
  var PrefixMatrix = "matrix3d("; 
  var CssString = window.getComputedStyle(document.getElementById(s), null).getPropertyValue("transform"); //利用getComputedStyle取得元素上CSS transform屬性值，結果是matrix3d(,,,,,,,,,,,)字串
  Parameters = CssString.substring(PrefixMatrix.length,CssString.length-1).split(", ");
  
  switch(target)
  {
    case "Wx": 
      Parameters[4]=Math.tan(toRadian(value));
      Parameters[8]=Math.tan(toRadian(value));
      val = PrefixMatrix+Parameters.join()+")";
      document.getElementById(s).style.transform=val;
      document.getElementById(s).style.WebkitTransform=val;
      break;
    case "Wy":
      Parameters[1]=Math.tan(toRadian(value));
      Parameters[9]=Math.tan(toRadian(value));
      val = PrefixMatrix+Parameters.join()+")";
      document.getElementById(s).style.transform=val;
      document.getElementById(s).style.WebkitTransform=val;
      break;
    case "Wz":
      Parameters[2]=Math.tan(toRadian(value));
      Parameters[6]=Math.tan(toRadian(value));
      val = PrefixMatrix+Parameters.join()+")";
      document.getElementById(s).style.transform=val;
      document.getElementById(s).style.WebkitTransform=val;
      break;
  }
}
</script>

</head>
<body>
  <div class="standpoint" id="stand">
    <div class="wall"></div>
    <div class="photo" id="photo"></div>
  </div>
  <fieldset>
  	<legend>Camera View</legend>
    <label>X軸</label><input id="X" value="0" type="range" min="-800" max="1000" step="1" onchange="change_position(this)">
    <label>Y軸</label><input id="Y" value="0" type="range" min="-800" max="800" step="1" onchange="change_position(this)">
    <label>Z軸</label><input id="Z" value="600" type="range" min="50" max="2000" step="1" onchange="change_depth(this)">
    <label>Preserve-3D</label><input id="D" type="checkbox" onchange="change_preserve(this)">
  </fieldset>
  <fieldset>
  	<legend>Translate</legend>
    <label>X軸</label><input id="Tx" value="137" type="range" min="0" max="274" step="1" onchange="Translate(this)">
    <label>Y軸</label><input id="Ty" value="102" type="range" min="0" max="204" step="1" onchange="Translate(this)">
    <label>Z軸</label><input id="Tz" value="0" type="range" min="-500" max="500" step="1" onchange="Translate(this)">
  </fieldset>
  <fieldset>
    <legend>Scale</legend>
    <label>X軸</label><input id="Sx" value="1" type="range" min="-2" max="2" step="0.1" onchange="Scale(this)">
    <label>Y軸</label><input id="Sy" value="1" type="range" min="-2" max="2" step="0.1" onchange="Scale(this)">
    <label>Z軸</label><input id="Sz" value="1" type="range" min="-2" max="2" step="0.1" onchange="Scale(this)">
  </fieldset>
  <fieldset>
    <legend>Rotate</legend>
    <label>X軸</label><input id="Rx" value="0" type="range" min="-360" max="360" step="1" onchange="Rotate(this)">
    <label>Y軸</label><input id="Ry" value="0" type="range" min="-360" max="360" step="1" onchange="Rotate(this)">
    <label>Z軸</label><input id="Rz" value="0" type="range" min="-360" max="360" step="1" onchange="Rotate(this)">
  </fieldset>
  <fieldset>
    <legend>Skew</legend>
    <label>X軸</label><input id="Wx" value="180" type="range" min="0" max="360" step="1" onchange="Skew(this)">
    <label>Y軸</label><input id="Wy" value="180" type="range" min="0" max="360" step="1" onchange="Skew(this)">
    <label>Z軸</label><input id="WZ" value="180" type="range" min="0" max="360" step="1" onchange="Skew(this)">
  </fieldset>
</body>
</html>