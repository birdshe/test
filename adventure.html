<html>
	<head>
		<link rel="stylesheet" type="text/css" href="./css/adventure.css" >
		<meta charset="utf-8">
		<title>map</title>
	</head>
	
	<body>
		<div class="navigator-div">
			<ul>
				<li>hello</li>
				<li>hello</li>
			</ul>
		</div>
		<div class="adventure-div">
			<table>
			</table>
			<img src="./Image/Role/frame-1.png" class="role-image">
		</div>
		<div class="adventure-div">
			<table>
			</table>
		</div>
	</body>
	
	<script>
		var BasicW, BasicH;
		var roleImage=document.getElementsByClassName('role-image')[0];
		var adventureDivs=document.getElementsByClassName('adventure-div');
		const XStep=20;
		const YStep=10;
		
		var roleAnimation={
			isGoOn:false,
			ImageId:1,
			aniId:1,
			start:function(){
				let self=this;
				console.log('ok');
				if(self.isGoOn === false){
					self.isGoOn=true;
					this.aniId=setInterval(function(){
						self.ImageId=(self.ImageId+1)%5 ? (self.ImageId+1)%5:5;
						roleImage.src=`./Image/Role/frame-${self.ImageId}.png`;
					},100);
				}
			},
			stop:function(){
				let self=this;
				if(self.isGoOn === true){
					self.isGoOn=false;
					clearInterval(self.aniId);
				}
			}
		};
		
		function setRole(x, y){
			let div=document.getElementsByClassName('adventure-div')[0];
			roleImage.style.top=(div.offsetTop+BasicH*y)+"px";
			roleImage.style.left=(div.offsetLeft+BasicW*x)+"px";
		}
		
		let adventureDiv=document.getElementsByClassName('adventure-div');
		window.onload=function(){	
			BasicW=document.getElementsByClassName('adventure-div')[0].offsetWidth/XStep;
			BasicH=document.getElementsByClassName('adventure-div')[0].offsetHeight/YStep;
			
			roleImage.height=BasicH;
			roleImage.width=BasicW;
			
			setRole(19, 0);
		}
		
		adventureDivs[0].addEventListener('click', (event)=>{
			let targetX=Math.floor(event.offsetX/BasicW);
			let targetY=Math.floor(event.offsetY/BasicH);
			
			setRole(targetX, targetY);
		})
		
		roleImage.addEventListener('click', (event)=>{
			event.stopPropagation(); //按到圖片會怪怪的
		});
	</script>
</html>